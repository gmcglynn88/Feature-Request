<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Feature Request Form | IPI Consulting</title>
  <style>
    /* Your Color Scheme */
    :root {
      --primary-color: #63AB8F; /* Your teal */
      --primary-dark: #4A8C7D;  /* Your darker teal */
      --primary-light: #8FC8B5; /* Your lighter teal */
      --secondary-color: #63AB8F; /* Same as primary for consistency */
      --accent-color: #FF6B35;
      --light-bg: #F8F9FA;
      --card-bg: #FFFFFF;
      --border-color: #DEE2E6;
      --text-dark: #2C3E50;
      --text-medium: #4A5568;
      --text-light: #718096;
      --error-color: #E53E3E;
      --success-color: #38A169;
      --warning-color: #D69E2E;
      --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }
    
    /* Reset and Base Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(135deg, var(--primary-light) 0%, var(--primary-color) 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
      color: var(--text-dark);
      line-height: 1.6;
    }
    
    /* Main Container */
    .container {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
    }
    
    /* Header Section */
    .header {
      text-align: center;
      margin-bottom: 30px;
    }
    
    .logo-container {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: var(--shadow);
      display: inline-block;
      margin-bottom: 20px;
    }
    
    .logo {
      height: 60px;
      width: auto;
    }
    
    .header-title {
      color: white;
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 10px;
      text-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .header-subtitle {
      color: rgba(255,255,255,0.9);
      font-size: 1.1rem;
      max-width: 600px;
      margin: 0 auto;
    }
    
    /* Card Styles */
    .card {
      background: var(--card-bg);
      border-radius: 16px;
      box-shadow: var(--shadow-lg);
      overflow: hidden;
      margin-bottom: 30px;
    }
    
    .card-header {
      background: var(--primary-color);
      color: white;
      padding: 24px 32px;
    }
    
    .card-title {
      font-size: 1.5rem;
      font-weight: 600;
      margin: 0;
    }
    
    .card-subtitle {
      opacity: 0.9;
      margin-top: 4px;
      font-size: 0.95rem;
    }
    
    .card-body {
      padding: 32px;
    }
    
    /* Authentication Section */
    .auth-section {
      text-align: center;
      padding: 60px 40px;
    }
    
    .auth-icon {
      font-size: 3rem;
      margin-bottom: 20px;
      color: var(--primary-color);
    }
    
    .auth-title {
      font-size: 1.8rem;
      margin-bottom: 12px;
      color: var(--text-dark);
    }
    
    .auth-description {
      color: var(--text-medium);
      margin-bottom: 30px;
      max-width: 500px;
      margin-left: auto;
      margin-right: auto;
    }
    
    /* Button Styles */
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 12px 28px;
      border-radius: 8px;
      font-weight: 600;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      border: none;
      text-decoration: none;
      gap: 10px;
    }
    
    .btn-primary {
      background: var(--primary-color);
      color: white;
    }
    
    .btn-primary:hover {
      background: var(--primary-dark);
      transform: translateY(-2px);
      box-shadow: var(--shadow);
    }
    
    .btn-secondary {
      background: var(--secondary-color);
      color: white;
    }
    
    .btn-full {
      width: 100%;
      padding: 16px;
      font-size: 1.1rem;
    }
    
    /* Form Styles */
    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 24px;
      margin-bottom: 32px;
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-group.full-width {
      grid-column: 1 / -1;
    }
    
    .form-label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: var(--text-dark);
      font-size: 0.95rem;
    }
    
    .form-label.required::after {
      content: " *";
      color: var(--error-color);
    }
    
    .form-control {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid var(--border-color);
      border-radius: 8px;
      font-size: 1rem;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
      background: white;
    }
    
    .form-control:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(99, 171, 143, 0.1);
    }
    
    .form-control.error {
      border-color: var(--error-color);
    }
    
    textarea.form-control {
      min-height: 120px;
      resize: vertical;
      font-family: inherit;
    }
    
    /* Error Messages */
    .error-message {
      color: var(--error-color);
      font-size: 0.875rem;
      margin-top: 6px;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    /* Success Message */
    .success-message {
      background: linear-gradient(135deg, #C6F6D5 0%, #9AE6B4 100%);
      border-radius: 12px;
      padding: 32px;
      text-align: center;
      margin: 20px 0;
    }
    
    .success-icon {
      font-size: 3rem;
      color: var(--success-color);
      margin-bottom: 16px;
    }
    
    .success-title {
      color: var(--success-color);
      font-size: 1.5rem;
      margin-bottom: 12px;
    }
    
    .success-content {
      color: var(--text-medium);
      margin-bottom: 20px;
    }
    
    /* Status Indicators */
    .status-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 30px;
      padding: 20px;
      background: var(--light-bg);
      border-radius: 12px;
    }
    
    .status-item {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .status-icon {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 0.75rem;
      font-weight: bold;
    }
    
    .status-icon.active {
      background: var(--primary-color);
    }
    
    .status-icon.inactive {
      background: var(--text-light);
    }
    
    .status-text {
      font-weight: 600;
      color: var(--text-dark);
    }
    
    /* Utility Classes */
    .hidden {
      display: none !important;
    }
    
    .text-center {
      text-align: center;
    }
    
    .mt-20 {
      margin-top: 20px;
    }
    
    .mt-30 {
      margin-top: 30px;
    }
    
    .mb-20 {
      margin-bottom: 20px;
    }
    
    /* Footer/Info Section */
    .info-section {
      background: var(--light-bg);
      padding: 24px;
      border-radius: 12px;
      margin-top: 30px;
    }
    
    .info-title {
      font-size: 1.2rem;
      margin-bottom: 16px;
      color: var(--text-dark);
    }
    
    .info-list {
      list-style: none;
    }
    
    .info-list li {
      padding: 8px 0;
      padding-left: 24px;
      position: relative;
      color: var(--text-medium);
    }
    
    .info-list li::before {
      content: "‚úì";
      position: absolute;
      left: 0;
      color: var(--primary-color);
      font-weight: bold;
    }
    
    /* Responsive Design */
    @media (max-width: 768px) {
      body {
        padding: 10px;
      }
      
      .header-title {
        font-size: 2rem;
      }
      
      .card-body {
        padding: 20px;
      }
      
      .form-grid {
        grid-template-columns: 1fr;
        gap: 16px;
      }
      
      .status-bar {
        flex-direction: column;
        gap: 15px;
        align-items: flex-start;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div class="header">
      <div class="logo-container">
        <img src="https://raw.githubusercontent.com/gmcglynn88/ExternalWorkCreation/main/Consultinglogo.png" alt="IPI Consulting" class="logo">
      </div>
      <h1 class="header-title">Feature Request Portal</h1>
      <p class="header-subtitle">Submit, track, and manage feature requests for IPI Consulting solutions</p>
    </div>
    
    <!-- Authentication Section -->
    <div id="authSection" class="card">
      <div class="card-body auth-section">
        <div class="auth-icon">üîê</div>
        <h2 class="auth-title">Authentication Required</h2>
        <p class="auth-description">Please authenticate with your Genesys Cloud account to access the feature request submission portal.</p>
        <button id="signinBtn" class="btn btn-primary">
          <span>Sign in with Genesys Cloud</span>
        </button>
      </div>
    </div>
    
    <!-- Main Content (Hidden by default) -->
    <div id="mainContent" class="hidden">
      <!-- Status Bar -->
      <div class="status-bar">
        <div class="status-item">
          <div class="status-icon active">1</div>
          <span class="status-text">Authentication Complete</span>
        </div>
        <div class="status-item">
          <div class="status-icon active">2</div>
          <span class="status-text">Complete Form</span>
        </div>
        <div class="status-item">
          <div class="status-icon inactive">3</div>
          <span class="status-text">Submit Request</span>
        </div>
      </div>
      
      <!-- Main Form Card -->
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">New Feature Request</h2>
          <p class="card-subtitle">Complete all required fields to submit your request</p>
        </div>
        <div class="card-body">
          <form id="featureRequestForm">
            <div class="form-grid">
              <!-- Personal Information -->
              <div class="form-group">
                <label for="name" class="form-label required">Full Name</label>
                <input type="text" id="name" class="form-control" placeholder="John Smith" required>
                <div id="nameError" class="error-message hidden">‚ö† Please enter your name</div>
              </div>
              
              <div class="form-group">
                <label for="role" class="form-label required">Role/Position</label>
                <input type="text" id="role" class="form-control" placeholder="e.g., Supervisor, Manager, Analyst" required>
                <div id="roleError" class="error-message hidden">‚ö† Please specify your role</div>
              </div>
              
              <div class="form-group">
                <label for="company" class="form-label required">Organization</label>
                <input type="text" id="company" class="form-control" placeholder="Your company name" required>
                <div id="companyError" class="error-message hidden">‚ö† Please enter your organization name</div>
              </div>
              
              <!-- Request Details -->
              <div class="form-group">
                <label for="appRequestType" class="form-label required">Request Type</label>
                <select id="appRequestType" class="form-control" required>
                  <option value="">Select request type</option>
                  <option value="Existing App Enhancement">Existing App Enhancement</option>
                  <option value="Reporting & Analytics">Reporting & Analytics</option>
                  <option value="Data Extraction">Data Extraction</option>
                  <option value="Administration App">Administration App</option>
                  <option value="Other">Other</option>
                </select>
                <div id="appRequestTypeError" class="error-message hidden">‚ö† Please select a request type</div>
              </div>
              
              <div class="form-group hidden" id="otherTypeField">
                <label for="otherType" class="form-label required">Specify Request Type</label>
                <input type="text" id="otherType" class="form-control" placeholder="Describe your specific request type">
                <div id="otherTypeError" class="error-message hidden">‚ö† Please specify your request type</div>
              </div>
              
              <div class="form-group">
                <label for="csmName" class="form-label required">Customer Success Manager</label>
                <select id="csmName" class="form-control" required>
                  <option value="">Select your CSM</option>
                  <option value="Beccy Hunt">Beccy Hunt</option>
                  <option value="Dawn Poustie">Dawn Poustie</option>
                  <option value="Vicki Coleman">Vicki Coleman</option>
                </select>
                <div id="csmNameError" class="error-message hidden">‚ö† Please select your CSM</div>
              </div>
              
              <!-- Text Areas -->
              <div class="form-group full-width">
                <label for="useCase" class="form-label required">Use Case Description</label>
                <textarea id="useCase" class="form-control" placeholder="Describe your specific use case, including:
‚Ä¢ What problem are you trying to solve?
‚Ä¢ Who will use this feature?
‚Ä¢ How will it benefit your team?
‚Ä¢ Any specific requirements or constraints?" required></textarea>
                <div id="useCaseError" class="error-message hidden">‚ö† Please provide a detailed use case (minimum 50 characters)</div>
              </div>
              
              <div class="form-group full-width">
                <label for="supportingInfo" class="form-label">Supporting Information</label>
                <textarea id="supportingInfo" class="form-control" placeholder="Additional context, screenshots description, links to related documents, or any other information that would help us understand your request better."></textarea>
              </div>
            </div>
            
            <!-- Success Message -->
            <div id="formSuccess" class="success-message hidden">
              <div class="success-icon">‚úì</div>
              <h3 class="success-title">Request Submitted Successfully!</h3>
              <p class="success-content">Your feature request has been logged in our system. You'll receive a confirmation email with tracking details shortly.</p>
              <button type="button" onclick="resetForm()" class="btn btn-primary">Submit Another Request</button>
            </div>
            
            <!-- Error Message -->
            <div id="formError" class="error-message hidden mb-20"></div>
            
            <!-- Submit Button -->
            <button type="submit" class="btn btn-primary btn-full">
              Submit Feature Request
            </button>
          </form>
        </div>
      </div>
      
      <!-- Information Section -->
      <div class="info-section">
        <h3 class="info-title">About This Portal</h3>
        <ul class="info-list">
          <li>All requests are reviewed by our development team within 3 business days</li>
          <li>You will receive email updates on request status and progress</li>
          <li>Your Customer Success Manager will be notified and can provide additional context</li>
          <li>Requests are prioritized based on business impact, feasibility, and alignment with our roadmap</li>
          <li>You can track the status of your requests through our customer portal</li>
        </ul>
      </div>
    </div>
  </div>

  <script>
    // ===== Configuration =====
    const CONFIG = {
      clientId: 'fe305808-b368-4547-8af9-325d28d552bb',
      redirectUri: window.location.origin + window.location.pathname,
      loginHost: 'https://login.mypurecloud.ie',
      apiHost: 'https://api.mypurecloud.ie'
    };

    // ===== Application State =====
    const state = { 
      token: null,
      user: null,
      isAuthenticated: false
    };

    // ===== DOM Helper =====
    const $ = id => document.getElementById(id);

    // ===== Authentication Functions =====
    function parseTokenFromHash() {
      const params = new URLSearchParams(location.hash.replace(/^#/, ''));
      return { 
        token: params.get('access_token'), 
        error: params.get('error'), 
        errorDescription: params.get('error_description'),
        expiresIn: params.get('expires_in')
      };
    }

    function generateAuthUrl() {
      return `${CONFIG.loginHost}/oauth/authorize?client_id=${encodeURIComponent(CONFIG.clientId)}&response_type=token&redirect_uri=${encodeURIComponent(CONFIG.redirectUri)}`;
    }

    function initializeAuthentication() {
      console.log('[Auth] Initializing authentication process...');
      
      // Parse token from URL hash
      const { token, error, errorDescription, expiresIn } = parseTokenFromHash();
      
      // Clean up URL hash
      if (location.hash) {
        history.replaceState(null, '', location.pathname + location.search);
      }

      // Handle token from OAuth redirect
      if (token) {
        console.log('[Auth] Token received via OAuth redirect');
        handleSuccessfulAuth(token, expiresIn);
        return;
      }

      // Check for stored valid token
      const storedToken = sessionStorage.getItem('gc_token');
      const storedExpiry = sessionStorage.getItem('gc_token_expiry');
      
      if (storedToken && storedExpiry && Date.now() < parseInt(storedExpiry)) {
        console.log('[Auth] Using valid stored token');
        state.token = storedToken;
        showMainInterface();
        fetchUserInformation();
        return;
      }

      // Clear expired tokens
      if (storedToken) {
        sessionStorage.removeItem('gc_token');
        sessionStorage.removeItem('gc_token_expiry');
      }

      // Attempt auto-auth if no error occurred
      const authAttempted = sessionStorage.getItem('gc_auto_auth_attempted');
      if (!authAttempted && !error) {
        console.log('[Auth] Attempting automatic authentication');
        sessionStorage.setItem('gc_auto_auth_attempted', '1');
        location.assign(generateAuthUrl());
        return;
      }

      // Handle authentication errors
      if (error) {
        console.error('[Auth] Authentication error:', error, errorDescription);
        showAuthError(errorDescription || error);
      }

      // Show manual sign-in button
      setupSignInButton();
    }

    function handleSuccessfulAuth(token, expiresIn) {
      sessionStorage.removeItem('gc_auto_auth_attempted');
      state.token = token;
      
      // Store token with expiry
      sessionStorage.setItem('gc_token', token);
      if (expiresIn) {
        const expiryTime = Date.now() + (parseInt(expiresIn) * 1000);
        sessionStorage.setItem('gc_token_expiry', expiryTime.toString());
      }
      
      showMainInterface();
      fetchUserInformation();
    }

    function setupSignInButton() {
      const signInBtn = $('signinBtn');
      signInBtn.style.display = 'inline-flex';
      signInBtn.onclick = () => { 
        sessionStorage.setItem('gc_auto_auth_attempted', '1'); 
        location.assign(generateAuthUrl()); 
      };
    }

    function showAuthError(message) {
      console.error('Auth error:', message);
    }

    function showMainInterface() {
      $('authSection').classList.add('hidden');
      $('mainContent').classList.remove('hidden');
    }

    // ===== API Functions =====
    async function callApi(endpoint) {
      if (!state.token) {
        throw new Error('Authentication required');
      }
      
      const response = await fetch(`${CONFIG.apiHost}${endpoint}`, { 
        headers: {
          Authorization: `Bearer ${state.token}`,
          'Content-Type': 'application/json'
        } 
      });
      
      if (response.status === 401 || response.status === 403) {
        // Token expired or invalid
        clearAuthentication();
        location.reload();
        throw new Error('Session expired. Please sign in again.');
      }
      
      if (!response.ok) { 
        const errorText = await response.text().catch(() => ''); 
        throw new Error(`API Error: ${response.status} - ${errorText.slice(0, 200)}`); 
      }
      
      return response.json();
    }

    async function fetchUserInformation() {
      try {
        const userData = await callApi('/api/v2/users/me');
        state.user = userData;
        populateUserData(userData);
      } catch (error) {
        console.warn('[API] Could not fetch user information:', error);
      }
    }

    function populateUserData(userData) {
      if (userData.name) {
        $('name').value = userData.name;
      }
      
      if (userData.email) {
        const emailDomain = userData.email.split('@')[1];
        if (emailDomain) {
          const domainName = emailDomain.split('.')[0];
          $('company').value = domainName.charAt(0).toUpperCase() + domainName.slice(1);
        }
      }
    }

    function clearAuthentication() {
      sessionStorage.removeItem('gc_token');
      sessionStorage.removeItem('gc_token_expiry');
      sessionStorage.removeItem('gc_auto_auth_attempted');
      state.token = null;
      state.user = null;
    }

    // ===== Form Handling =====
    function initializeForm() {
      // Show/hide other type field
      $('appRequestType').addEventListener('change', function() {
        const otherField = $('otherTypeField');
        const otherInput = $('otherType');
        
        if (this.value === 'Other') {
          otherField.classList.remove('hidden');
          otherInput.required = true;
        } else {
          otherField.classList.add('hidden');
          otherInput.required = false;
          otherInput.value = '';
        }
      });

      // Form submission
      $('featureRequestForm').addEventListener('submit', async function(event) {
        event.preventDefault();
        
        // Reset UI states
        clearFormErrors();
        $('formError').classList.add('hidden');
        $('formSuccess').classList.add('hidden');
        
        // Validate form
        if (!validateFormSubmission()) {
          return;
        }
        
        // Prepare submission data
        const formData = prepareFormData();
        
        // Submit data
        try {
          await submitFeatureRequest(formData);
          showSuccessMessage();
        } catch (error) {
          showSubmissionError(error.message);
        }
      });
    }

    function prepareFormData() {
      let requestType = $('appRequestType').value;
      
      if (requestType === 'Other') {
        requestType = `Other: ${$('otherType').value.trim()}`;
      }
      
      return {
        name: $('name').value.trim(),
        role: $('role').value.trim(),
        company: $('company').value.trim(),
        appRequestType: requestType,
        useCase: $('useCase').value.trim(),
        csmName: $('csmName').value,
        supportingInfo: $('supportingInfo').value.trim(),
        submittedBy: state.user ? state.user.name : 'Unknown',
        submittedByEmail: state.user ? state.user.email : 'Unknown',
        submittedAt: new Date().toISOString(),
        status: 'New',
        priority: 'Medium',
        requestId: generateRequestId()
      };
    }

    function generateRequestId() {
      return `FR-${Date.now()}-${Math.random().toString(36).substr(2, 9).toUpperCase()}`;
    }

    function validateFormSubmission() {
      let isValid = true;
      
      // Required field validations
      const validations = [
        { id: 'name', errorId: 'nameError', message: 'Full name is required' },
        { id: 'role', errorId: 'roleError', message: 'Role/position is required' },
        { id: 'company', errorId: 'companyError', message: 'Organization name is required' },
        { id: 'appRequestType', errorId: 'appRequestTypeError', message: 'Please select a request type' },
        { id: 'csmName', errorId: 'csmNameError', message: 'Please select your Customer Success Manager' }
      ];
      
      validations.forEach(validation => {
        const element = $(validation.id);
        if (!element.value.trim()) {
          showFieldError(validation.errorId, validation.message);
          element.classList.add('error');
          isValid = false;
        } else {
          element.classList.remove('error');
        }
      });
      
      // Special validation for "Other" type
      if ($('appRequestType').value === 'Other' && !$('otherType').value.trim()) {
        showFieldError('otherTypeError', 'Please specify your request type');
        $('otherType').classList.add('error');
        isValid = false;
      } else {
        $('otherType').classList.remove('error');
      }
      
      // Use case validation
      const useCase = $('useCase').value.trim();
      if (!useCase) {
        showFieldError('useCaseError', 'Use case description is required');
        $('useCase').classList.add('error');
        isValid = false;
      } else if (useCase.length < 50) {
        showFieldError('useCaseError', 'Please provide a more detailed use case (minimum 50 characters)');
        $('useCase').classList.add('error');
        isValid = false;
      } else {
        $('useCase').classList.remove('error');
      }
      
      return isValid;
    }

    function showFieldError(elementId, message) {
      const element = $(elementId);
      element.textContent = message;
      element.classList.remove('hidden');
    }

    function clearFormErrors() {
      document.querySelectorAll('.error-message').forEach(el => {
        el.classList.add('hidden');
        el.textContent = '';
      });
      
      document.querySelectorAll('.form-control.error').forEach(el => {
        el.classList.remove('error');
      });
    }

    function showSuccessMessage() {
      $('formSuccess').classList.remove('hidden');
      $('featureRequestForm').reset();
      $('otherTypeField').classList.add('hidden');
      $('otherType').required = false;
      
      // Restore user data if available
      if (state.user && state.user.name) {
        $('name').value = state.user.name;
      }
      
      // Scroll to success message
      $('formSuccess').scrollIntoView({ behavior: 'smooth' });
    }

    function showSubmissionError(message) {
      const errorElement = $('formError');
      errorElement.textContent = `Submission failed: ${message}. Please try again or contact support.`;
      errorElement.classList.remove('hidden');
    }

    // ===== Submission Handler =====
    async function submitFeatureRequest(data) {
      console.log('[Submission] Submitting feature request:', data);
      
      // Simulate API call
      await new Promise(resolve => setTimeout(resolve, 1500));
      
      // Store in localStorage for demo
      const existingRequests = JSON.parse(localStorage.getItem('ipi_feature_requests') || '[]');
      existingRequests.push(data);
      localStorage.setItem('ipi_feature_requests', JSON.stringify(existingRequests));
      
      return {
        success: true,
        requestId: data.requestId,
        timestamp: new Date().toISOString()
      };
    }

    // ===== Form Reset =====
    function resetForm() {
      $('featureRequestForm').reset();
      $('otherTypeField').classList.add('hidden');
      $('otherType').required = false;
      $('formSuccess').classList.add('hidden');
      $('formError').classList.add('hidden');
      clearFormErrors();
      
      // Restore user info
      if (state.user && state.user.name) {
        $('name').value = state.user.name;
      }
    }

    // ===== Application Initialization =====
    document.addEventListener('DOMContentLoaded', () => {
      initializeAuthentication();
      initializeForm();
    });

    // Make resetForm globally available
    window.resetForm = resetForm;
  </script>
</body>
</html>
